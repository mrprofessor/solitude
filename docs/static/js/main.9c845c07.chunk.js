(this.webpackJsonpsolitude=this.webpackJsonpsolitude||[]).push([[0],{205:function(e,t,n){e.exports=n(576)},214:function(e,t,n){},229:function(e,t,n){},573:function(e,t,n){},574:function(e,t,n){},575:function(e,t,n){},576:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(7),i=n.n(o),c=n(65),l=n(12),u=function(e){return{type:"UPDATE_MARKDOWN_VALUE",text:e}},s=function(e){return{type:"UPDATE_PANE_SIZE",size:e}},d=n(88),m=n(177),h=(n(214),function(e){var t=e.onViewModeChange;return a.a.createElement("div",{className:"appbar"},a.a.createElement("div",{className:"logo"},a.a.createElement("span",null,"Solitude")),a.a.createElement("div",{className:"modebar"},a.a.createElement(d.b,{width:"22",height:"22",onClick:function(){return t("100%")}}),a.a.createElement(d.a,{width:"22",height:"22",onClick:function(){return t("50%")}}),a.a.createElement(m.a,{width:"22",height:"22",onClick:function(){return t("0%")}})))}),p=Object(l.b)(null,(function(e){return{onViewModeChange:function(t){return e(s(t))}}}))(h),f=n(178),E=n(179),b=(n(216),n(217),n(133),n(218),n(219),n(220),n(221),n(222),n(223),n(135),n(226),n(228),n(229),function(e){var t=e.onValueChange,n=e.onSelectedEditorChange,r=e.markdownValue;return a.a.createElement(E.Controlled,{options:{mode:"gfm",lineNumbers:!0,spellcheck:!0,theme:"neo"},value:r,onBeforeChange:function(e,n,r){t(r)},onSelection:function(e,t){n(e)},height:"100%"})}),g=Object(l.b)((function(e){return{markdownValue:e.markdownValue}}),(function(e){return{onValueChange:function(t){return e(u(t))},onSelectedEditorChange:function(t){return e({type:"UPDATE_EDITOR_STATE",editorState:t})}}}))(b),v=n(180),O=n.n(v),w=n(181),y=n(182),S=n(200),T=n(183),k=n(201),_=n(586),j=n(582),C=function(e){function t(){return Object(w.a)(this,t),Object(S.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props,t=e.language,n=e.value;return a.a.createElement(_.a,{language:t,style:j.a},n)}}]),t}(r.PureComponent);C.defaultProps={language:null};var I=C,D=Object(l.b)((function(e){return{markdownValue:e.markdownValue}}))((function(e){var t=e.markdownValue;return a.a.createElement(O.a,{className:"react-markdown",source:t,escapeHtml:!1,renderers:{code:I}})})),P=function(e){var t=e.paneSize,n=e.onPaneSizeChange;return a.a.createElement(f.a,{split:"vertical",defaultSize:t,size:t,onDragFinished:function(e){return n(e)}},a.a.createElement("div",{className:"editor-pane"},"0%"!==t&&a.a.createElement(g,null)),a.a.createElement("div",{className:"result-pane"},a.a.createElement(D,null)))},R=Object(l.b)((function(e){return{paneSize:e.splitPane.size}}),(function(e){return{onPaneSizeChange:function(t){return e(s(t))}}}))(P),N=n(33),A=n(193),U=n(194),L=n(46),M=n(36),$=n(31),x=n(583);function z(){var e=Object(L.a)(["\n  {\n    viewer {\n      id\n      login\n      avatarUrl\n    }\n  }\n"]);return z=function(){return e},e}var V=Object($.b)(z()),B=function(){var e=Object(M.b)(V),t=(e.loading,e.error,e.data),n=Object(l.c)();return t&&t.viewer.login&&n(function(e){var t=e.login;return{type:"UPDATE_GIT_USER",id:e.id,login:t}}(t.viewer)),a.a.createElement(x.a,{src:t&&t.viewer.avatarUrl,size:"small"})},W=n(64),G=(n(131),n(66)),H=n.n(G),F=n(74),X=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){return n(e)},r.readAsText(e)}))},q=function(e){var t=e.type,n=void 0===t?"":t,r=e.editorState;if(Object(F.isEmpty)(r))return null;var a=r.getSelection(),o=r.getCursor();switch(n){case"header":r.setCursor(o.line,0);var i=r.getCursor().line,c=r.getCursor().ch,l=r.findWordAt({line:i,ch:c}).anchor.ch,u=r.findWordAt({line:i,ch:c}).head.ch;if(r.setSelection({line:i,ch:l},{line:i,ch:u}),a=r.getSelection(),/^#{1,5}$/.test(a))r.replaceSelection(a+"#");else{if(/^#{6,}$/.test(a))break;r.replaceSelection("# "+a)}r.focus();break;case"bold":r.replaceSelection("**"+(a||" ")+"**"),r.focus();break;case"italic":r.replaceSelection("*"+(a||" ")+"*"),r.focus();break;case"strikethrough":r.replaceSelection("~~"+(a||" ")+"~~"),r.focus();break;case"hr":r.setCursor(o.line+1,0),r.replaceSelection("\n\n---\n"),r.focus();break;case(n.match(/h[1-6]{1}/)||{}).input:r.setCursor(o.line,0),r.replaceSelection("#".repeat(Number(n[1]))+" "),r.focus();break;case"table":r.setCursor(o.line,0),r.replaceSelection("\n| Tables        | Are           | Cool  |\n| ------------- |:-------------:| -----:|\n| col 3 is      | right-aligned | $1600 |\n| col 2 is      | centered      |   $12 |\n| zebra stripes | are neat      |    $1 |\n"),r.focus();break;case"code":r.replaceSelection("\n```language\n".concat(a,"\n```\n")),r.focus();break;default:r.replaceSelection(a)}},J=function(e){return"".concat(e,"-solitude-notes")},K=n(585),Y=function(e){var t=e.modalTitle,n=void 0===t?"Custom modal":t,r=e.isModalOpen,o=e.modalBody,i=e.onModalClose;return a.a.createElement(K.a,{title:n,visible:r,onOk:function(){return i()},onCancel:function(){return i()}},o)},Z=function(e){var t=e.editorState,n=e.token,r=e.handleNewFileUpload,o=e.handleModalOpen;return a.a.createElement("div",{className:"toolbar"},a.a.createElement("ul",null,a.a.createElement("li",{onClick:function(){return q({type:"header",editorState:t})}},a.a.createElement(N.d,{width:"22",height:"22"})),a.a.createElement("li",{onClick:function(){return q({type:"bold",editorState:t})}},a.a.createElement(N.a,{width:"22",height:"22"})),a.a.createElement("li",{onClick:function(){return q({type:"italic",editorState:t})}},a.a.createElement(N.e,{width:"22",height:"22"})),a.a.createElement("li",{onClick:function(){return q({type:"strikethrough",editorState:t})}},a.a.createElement(N.h,{width:"22",height:"22"})),a.a.createElement("li",{onClick:function(){return q({type:"hr",editorState:t})}},a.a.createElement(N.f,{width:"22",height:"22"})),a.a.createElement("li",{onClick:function(){return q({type:"table",editorState:t})}},a.a.createElement(N.i,{width:"22",height:"22"})),a.a.createElement("li",{onClick:function(){return q({type:"code",editorState:t})}},a.a.createElement(N.b,{width:"22",height:"22"}))),a.a.createElement("ul",null,n?a.a.createElement(a.a.Fragment,null,a.a.createElement("li",{onClick:function(){return o({modalType:"GIT_MODAL"})}},a.a.createElement(U.a,{width:"22",height:"20"}))):a.a.createElement("li",null,a.a.createElement("a",{href:"https://github.com/login/oauth/authorize?client_id=".concat(W.GITHUB_APP_CLIENT_ID,"&scope=repo")},a.a.createElement(A.a,{width:"22",height:"20"}))),a.a.createElement("li",{onClick:function(e){return function(e){var t,n,r;return H.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=e.event,n=e.handleNewFileUpload,(r=document.createElement("input")).type="file",r.onchange=function(e){var t,r;return H.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.target.files[0],a.prev=1,a.next=4,H.a.awrap(X(t));case 4:r=a.sent,n(r),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),console.error(a.t0);case 11:case"end":return a.stop()}}),null,null,[[1,8]])},t.preventDefault(),r.click();case 6:case"end":return a.stop()}}))}({event:e,handleNewFileUpload:r})}},a.a.createElement(N.c,{width:"22",height:"22"})),a.a.createElement("li",{onClick:function(){return function(e){var t=e.editorState,n=e.fileName,r=document.createElement("a"),a="";Object(F.isEmpty)(t)||(a=t.getValue());var o=new Blob([a],{type:"text/plain"});r.href=URL.createObjectURL(o),r.download=n,document.body.appendChild(r),r.click()}({fileName:"solitude.md",editorState:t})}},a.a.createElement(N.g,{width:"22",height:"22"})),n&&a.a.createElement("li",null,a.a.createElement(B,null))))},Q=Object(l.b)((function(e){return{editorState:e.editor,token:e.auth.token}}),(function(e){return{handleNewFileUpload:function(t){return e(u(t))},handleModalOpen:function(t){return e({type:"SHOW_MODAL",modalType:(n=t).modalType,modalProps:n.modalProps});var n}}}))(Z),ee=n(195),te=n(75),ne=function(e){var t=e.onClick,n=e.style,r=e.label;Object(ee.a)(e,["onClick","style","label"]);return a.a.createElement(te.a,{onClick:function(e){return t(e)},style:n},r)},re=n(584);function ae(){var e=Object(L.a)(["\n  query LoadNote($owner: String!, $name: String!, $expression: String!) {\n    repository(owner: $owner, name: $name) {\n      id\n      name\n      nameWithOwner\n      note: object(expression: $expression) {\n        ... on Blob {\n          text\n          byteSize\n        }\n      }\n    }\n  }\n"]);return ae=function(){return e},e}var oe=Object($.b)(ae()),ie=function(e){var t=e.notes,n=Object(r.useState)({name:""}),o=Object(c.a)(n,2),i=o[0],s=o[1],d=Object(l.d)((function(e){return e.auth.userName})),m=Object(l.c)(),h={owner:d,name:J(d),expression:"master:notes/".concat(i.name,"/index.md")},p=Object(M.b)(oe,{variables:h,fetchPolicy:"no-cache"},[i]),f=p.loading,E=p.error,b=p.data;return Object(r.useEffect)((function(){var e=function(e){var t=e.repository.note;t&&m(u(t.text))&&m({type:"HIDE_MODAL"})},t=function(e){console.log(e)};(e||t)&&(!e||f||E?t&&!f&&E&&t(E):e(b))}),[f,b,E]),a.a.createElement(re.a,{bordered:!0,split:!0,dataSource:t,renderItem:function(e){return a.a.createElement(re.a.Item,{key:e.oid,onClick:function(){return s(e)},style:{cursor:"pointer"}},e.name)}})};function ce(){var e=Object(L.a)(['\n  query SolitudeNoteRepo($owner: String!, $name: String!) {\n    repository(owner: $owner, name: $name) {\n      id\n      name\n      nameWithOwner\n      templateRepository {\n        id\n        name\n      }\n      notes: object(expression: "master:notes/") {\n        ... on Tree {\n          entries {\n            oid\n            object {\n              ... on Blob {\n                text\n              }\n            }\n            name\n          }\n        }\n      }\n    }\n  }\n']);return ce=function(){return e},e}var le=Object($.b)(ce()),ue=function(e){var t=e.updateRepository,n=Object(l.d)((function(e){return e.auth.userName})),o={owner:n,name:J(n)},i=Object(M.b)(le,{variables:o,fetchPolicy:"no-cache"}),c=i.loading,u=i.error,s=i.data;return Object(r.useEffect)((function(){var e=function(e){var n=e.repository,r=n.id,a=n.name,o=n.nameWithOwner;t({id:r,name:a,nameWithOwner:o,loading:c})},n=function(e){t({loading:c}),console.log(e)};(e||n)&&(!e||c||u?n&&!c&&u&&n(u):e(s))}),[c,s,u]),a.a.createElement("div",null,c?a.a.createElement("span",null,"Loading..."):a.a.createElement(a.a.Fragment,null,s?a.a.createElement("div",null,a.a.createElement("h3",null,s.repository.nameWithOwner),a.a.createElement(ie,{notes:s.repository.notes.entries})):a.a.createElement("p",null,"No solitude managed repository exists!")))};function se(){var e=Object(L.a)(["\n  mutation CreateSolitudeNotesRepository(\n    $repoName: String!\n    $templateRepositoryId: String!\n    $ownerId: String!\n  ) {\n    cloneTemplateRepository(\n      input: {\n        name: $repoName\n        repositoryId: $templateRepositoryId\n        ownerId: $ownerId\n        visibility: PRIVATE\n      }\n    ) {\n      repository {\n        name\n      }\n    }\n  }\n"]);return se=function(){return e},e}var de=Object($.b)(se()),me=function(e){var t,n,o,i=e.auth,l=e.updateRepository,u=Object(M.a)(de),s=Object(c.a)(u,2),d=s[0],m=s[1].data,h=(t=W.TEMPLATE_REPOSITORY_ID,n=i.id,o=i.userName,{repoName:"".concat(o,"-solitude-notes"),templateRepositoryId:t,ownerId:n});return Object(r.useEffect)((function(){console.log(m),m&&m.cloneTemplateRepository&&l(m.cloneTemplateRepository.repository)}),[m]),a.a.createElement(ne,{label:"Create",onClick:function(e){d({variables:h})}})},he={GIT_MODAL:Object(l.b)((function(e){return{auth:e.auth,repository:e.repository}}),(function(e){return{hideModal:function(){return e({type:"HIDE_MODAL"})},updateRepository:function(t){return e(function(e){return{type:"REGISTER_SOLITUDE_REPO",repo:e}}(t))}}}))((function(e){var t=e.auth,n=e.isOpen,o=(e.modalProps,e.hideModal),i=e.updateRepository,c=e.repository;return Object(r.useEffect)((function(){i({loading:!0})}),[]),a.a.createElement(Y,{isModalOpen:n,modalTitle:"Your notes",modalBody:t.token?a.a.createElement("div",null,a.a.createElement(ue,{updateRepository:i}),!c.loading&&!c.name&&a.a.createElement(me,{auth:t,updateRepository:i})):a.a.createElement(ne,{label:"Connect to GitHub",onClick:function(e){return function(e){e.preventDefault();var t,n=(t=W.GITHUB_APP_CLIENT_ID,"https://github.com/login/oauth/authorize?client_id=".concat(t,"&scope=repo"));window.location.href=n}(e)}}),onModalClose:o})}))},pe=Object(l.b)((function(e){return{modal:e.modal}}))((function(e){var t=e.modal;if(console.log(t.modalType),!t.modalType)return null;var n=he[t.modalType];return a.a.createElement(n,t)})),fe=n(19),Ee=function(e){return new $.a({uri:"https://api.github.com/graphql",request:function(t){t.setContext({headers:{authorization:e?"Bearer ".concat(e):""}})}})};n(572),n(573),n(574),n(575);var be=Object(l.b)(null,(function(e){return{onTokenChange:function(t){return e(function(e){return{type:"UPDATE_TOKEN",token:e}}(t))}}}))((function(e){var t=e.onTokenChange,n=(e.authToken,Object(r.useState)("")),o=Object(c.a)(n,2),i=o[0],l=o[1];Object(r.useEffect)((function(){var e=window.location.href.match(/\?code=(.*)/)&&window.location.href.match(/\?code=(.*)/)[1];e&&fetch("https://solitudenote-gitkeeper.glitch.me/authenticate/".concat(e)).then((function(e){return e.json()})).then((function(e){var n=e.error,r=e.access_token;if(n)throw Error(n);console.log(r),l(r),t(r)})).catch((function(e){console.log(e)}))}),[]);var u=Ee(i);return a.a.createElement("div",null,a.a.createElement(fe.a,{client:u},a.a.createElement(p,null),a.a.createElement(Q,null),a.a.createElement(R,null),a.a.createElement(pe,null)))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ge=n(63),ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_EDITOR_STATE":return t.editorState||e;default:return e}},Oe=n(28),we=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{size:"50%"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_PANE_SIZE":return Object(Oe.a)({},e,{size:t.size});default:return e}},ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_MARKDOWN_VALUE":return t.text;default:return e}},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{token:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_TOKEN":return Object(Oe.a)({},e,{token:t.token});case"UPDATE_GIT_USER":return Object(Oe.a)({},e,{userName:t.login,id:t.id});default:return e}},Te={},ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_MODAL":return Object(Oe.a)({},e,{isOpen:!0,modalType:t.modalType,modalProps:t.modalProps});case"HIDE_MODAL":return Object(Oe.a)({},Te,{isOpen:!1});default:return e}},_e={loading:!0},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REGISTER_SOLITUDE_REPO":case"UPDATE_SOLITUDE_REPO":return Object(Oe.a)({},e,{},t.repo);default:return e}},Ce=Object(ge.b)({markdownValue:ye,editor:ve,splitPane:we,modal:ke,auth:Se,repository:je}),Ie=Object(ge.c)(Ce,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());i.a.render(a.a.createElement(l.a,{store:Ie},a.a.createElement(be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},64:function(e){e.exports=JSON.parse('{"GITHUB_APP_CLIENT_ID":"b4b9cca2169de74f183e","GITHUB_APP_REDIRECT_URI":"http://localhost:3000/","TEMPLATE_REPOSITORY_ID":"MDEwOlJlcG9zaXRvcnkyMzc2ODIwOTE="}')}},[[205,1,2]]]);
//# sourceMappingURL=main.9c845c07.chunk.js.map