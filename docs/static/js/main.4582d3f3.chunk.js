(this.webpackJsonpsolitude=this.webpackJsonpsolitude||[]).push([[0],{211:function(e,t,n){e.exports=n(586)},220:function(e,t,n){},235:function(e,t,n){},583:function(e,t,n){},584:function(e,t,n){},585:function(e,t,n){},586:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(7),c=n.n(o),i=n(47),l=n(10),u=function(e){return{type:"UPDATE_MARKDOWN_VALUE",text:e}},s=function(e){return{type:"UPDATE_PANE_SIZE",size:e}},d=n(92),m=n(182),h=(n(220),function(e){var t=e.onViewModeChange;return r.a.createElement("div",{className:"appbar"},r.a.createElement("div",{className:"logo"},r.a.createElement("span",null,"Solitude")),r.a.createElement("div",{className:"modebar"},r.a.createElement(d.b,{width:"22",height:"22",onClick:function(){return t("100%")}}),r.a.createElement(d.a,{width:"22",height:"22",onClick:function(){return t("50%")}}),r.a.createElement(m.a,{width:"22",height:"22",onClick:function(){return t("0%")}})))}),f=Object(l.b)(null,(function(e){return{onViewModeChange:function(t){return e(s(t))}}}))(h),p=n(183),E=n(184),b=(n(222),n(223),n(139),n(224),n(225),n(226),n(227),n(228),n(229),n(141),n(232),n(234),n(235),function(e){var t=e.onValueChange,n=e.onSelectedEditorChange,a=e.markdownValue;return r.a.createElement(E.Controlled,{options:{mode:"gfm",lineNumbers:!0,spellcheck:!0,theme:"neo"},value:a,onBeforeChange:function(e,n,a){t(a)},onSelection:function(e,t){n(e)},height:"100%"})}),O=function(){var e=Object(l.c)(),t=Object(l.d)((function(e){return e.editorValue}));return r.a.createElement(b,{markdownValue:t.markdownValue,onSelectedEditorChange:function(t){return e({type:"UPDATE_EDITOR_STATE",editorState:t})},onValueChange:function(n){var a;e(u(n)),t.noteId&&e({type:"UPDATE_NOTE",text:(a={text:n,oid:t.noteId,isDirty:!0}).text,oid:a.oid,isDirty:a.isDirty})}})},g=n(185),v=n.n(g),y=n(186),T=n(187),w=n(204),j=n(188),k=n(206),_=n(596),S=n(591),C=function(e){function t(){return Object(y.a)(this,t),Object(w.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){var e=this.props,t=e.language,n=e.value;return r.a.createElement(_.a,{language:t,style:S.a},n)}}]),t}(a.PureComponent);C.defaultProps={language:null};var N=C,I=Object(l.b)((function(e){return{markdownValue:e.editorValue.markdownValue}}))((function(e){var t=e.markdownValue;return r.a.createElement(v.a,{className:"react-markdown",source:t,escapeHtml:!1,renderers:{code:N}})})),D=function(e){var t=e.paneSize,n=e.onPaneSizeChange;return r.a.createElement(p.a,{split:"vertical",defaultSize:t,size:t,onDragFinished:function(e){return n(e)}},r.a.createElement("div",{className:"editor-pane"},"0%"!==t&&r.a.createElement(O,null)),r.a.createElement("div",{className:"result-pane"},r.a.createElement(I,null)))},A=Object(l.b)((function(e){return{paneSize:e.splitPane.size}}),(function(e){return{onPaneSizeChange:function(t){return e(s(t))}}}))(D),P=n(34),L=n(198),U=n(199),R=n(68),x=n(56),M=n(46),z=n(592);function V(){var e=Object(R.a)(["\n  {\n    viewer {\n      id\n      login\n      avatarUrl\n    }\n  }\n"]);return V=function(){return e},e}var W=Object(M.b)(V()),$=function(){var e=Object(x.b)(W),t=(e.loading,e.error,e.data),n=Object(l.c)();return t&&t.viewer.login&&n(function(e){var t=e.login;return{type:"UPDATE_GIT_USER",id:e.id,login:t}}(t.viewer)),r.a.createElement(z.a,{src:t&&t.viewer.avatarUrl,size:"small"})},B=n(69),F=n(70),G=n(71),H=n.n(G),J=n(57),X=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.onerror=function(e){return n(e)},a.readAsText(e)}))},K=function(e){var t=e.type,n=void 0===t?"":t,a=e.editorState;if(Object(J.isEmpty)(a))return null;var r=a.getSelection(),o=a.getCursor();switch(n){case"header":a.setCursor(o.line,0);var c=a.getCursor().line,i=a.getCursor().ch,l=a.findWordAt({line:c,ch:i}).anchor.ch,u=a.findWordAt({line:c,ch:i}).head.ch;if(a.setSelection({line:c,ch:l},{line:c,ch:u}),r=a.getSelection(),/^#{1,5}$/.test(r))a.replaceSelection(r+"#");else{if(/^#{6,}$/.test(r))break;a.replaceSelection("# "+r)}a.focus();break;case"bold":a.replaceSelection("**"+(r||" ")+"**"),a.focus();break;case"italic":a.replaceSelection("*"+(r||" ")+"*"),a.focus();break;case"strikethrough":a.replaceSelection("~~"+(r||" ")+"~~"),a.focus();break;case"hr":a.setCursor(o.line+1,0),a.replaceSelection("\n\n---\n"),a.focus();break;case(n.match(/h[1-6]{1}/)||{}).input:a.setCursor(o.line,0),a.replaceSelection("#".repeat(Number(n[1]))+" "),a.focus();break;case"table":a.setCursor(o.line,0),a.replaceSelection("\n| Tables        | Are           | Cool  |\n| ------------- |:-------------:| -----:|\n| col 3 is      | right-aligned | $1600 |\n| col 2 is      | centered      |   $12 |\n| zebra stripes | are neat      |    $1 |\n"),a.focus();break;case"code":a.replaceSelection("\n```language\n".concat(r,"\n```\n")),a.focus();break;default:a.replaceSelection(r)}},q=function(e,t,n,a){return"DELETE_FILE"===e?"https://api.github.com/repos/".concat(t,"/").concat(n,"/contents/").concat(a):"CREATE_FILE"===e?"https://api.github.com/repos/".concat(t,"/").concat(n,"/contents/").concat(a):"UPDATE_FILE"===e?"https://api.github.com/repos/".concat(t,"/").concat(n,"/contents/").concat(a):void 0},Y=n(595),Z=function(e){var t=e.modalTitle,n=void 0===t?"Custom modal":t,a=e.isModalOpen,o=e.modalBody,c=e.onModalClose;return r.a.createElement(Y.a,{title:n,visible:a,onOk:function(){return c()},onCancel:function(){return c()}},o)},Q=function(e){var t=e.editorState,n=e.token,a=e.handleNewFileUpload,o=e.handleModalOpen;return r.a.createElement("div",{className:"toolbar"},r.a.createElement("ul",null,r.a.createElement("li",{onClick:function(){return K({type:"header",editorState:t})}},r.a.createElement(P.d,{width:"22",height:"22"})),r.a.createElement("li",{onClick:function(){return K({type:"bold",editorState:t})}},r.a.createElement(P.a,{width:"22",height:"22"})),r.a.createElement("li",{onClick:function(){return K({type:"italic",editorState:t})}},r.a.createElement(P.e,{width:"22",height:"22"})),r.a.createElement("li",{onClick:function(){return K({type:"strikethrough",editorState:t})}},r.a.createElement(P.h,{width:"22",height:"22"})),r.a.createElement("li",{onClick:function(){return K({type:"hr",editorState:t})}},r.a.createElement(P.f,{width:"22",height:"22"})),r.a.createElement("li",{onClick:function(){return K({type:"table",editorState:t})}},r.a.createElement(P.i,{width:"22",height:"22"})),r.a.createElement("li",{onClick:function(){return K({type:"code",editorState:t})}},r.a.createElement(P.b,{width:"22",height:"22"}))),r.a.createElement("ul",null,n?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{onClick:function(){return o({modalType:"GIT_MODAL"})}},r.a.createElement(U.a,{width:"22",height:"20"}))):r.a.createElement("li",null,r.a.createElement("a",{href:"https://github.com/login/oauth/authorize?client_id=".concat(B.GITHUB_APP_CLIENT_ID,"&scope=repo")},r.a.createElement(L.a,{width:"22",height:"20"}))),r.a.createElement("li",{onClick:function(e){return function(e){var t,n,a;return H.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:t=e.event,n=e.handleNewFileUpload,(a=document.createElement("input")).type="file",a.onchange=function(e){var t,a;return H.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.target.files[0],r.prev=1,r.next=4,H.a.awrap(X(t));case 4:a=r.sent,n(a),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),console.error(r.t0);case 11:case"end":return r.stop()}}),null,null,[[1,8]])},t.preventDefault(),a.click();case 6:case"end":return r.stop()}}))}({event:e,handleNewFileUpload:a})}},r.a.createElement(P.c,{width:"22",height:"22"})),r.a.createElement("li",{onClick:function(){return function(e){var t=e.editorState,n=e.fileName,a=document.createElement("a"),r="";Object(J.isEmpty)(t)||(r=t.getValue());var o=new Blob([r],{type:"text/plain"});a.href=URL.createObjectURL(o),a.download=n,document.body.appendChild(a),a.click()}({fileName:"solitude.md",editorState:t})}},r.a.createElement(P.g,{width:"22",height:"22"})),n&&r.a.createElement("li",null,r.a.createElement($,null))))},ee=Object(l.b)((function(e){return{editorState:e.editor,token:e.auth.token}}),(function(e){return{handleNewFileUpload:function(t){return e(u(t))},handleModalOpen:function(t){return e({type:"SHOW_MODAL",modalType:(n=t).modalType,modalProps:n.modalProps});var n}}}))(Q),te=n(101),ne=n(50),ae=function(e){var t=e.onClick,n=e.style,a=e.label;Object(te.a)(e,["onClick","style","label"]);return r.a.createElement(ne.a,{onClick:function(e){return t(e)},style:n},a)},re=n(42),oe=n(593),ce=n(20),ie=n(597),le=function(e){var t=e.onClick,n=e.style,a=e.label,o=Object(te.a)(e,["onClick","style","label"]);return n=Object(ce.a)({cursor:"pointer"},n),r.a.createElement(ie.a,Object.assign({onClick:function(e){return t(e)},style:n},o),a)},ue=n(594).a.Search,se=function(e){var t=e.notes,n=e.editNote,o=e.deleteNote,c=e.saveNote,l=e.createNote,u=Object(a.useState)(""),s=Object(i.a)(u,2),d=s[0],m=s[1];return r.a.createElement("div",null,r.a.createElement(oe.a,{bordered:!0,split:!0,dataSource:t,renderItem:function(e){var t,a;return r.a.createElement(oe.a.Item,{key:e.oid,actions:[r.a.createElement(le,{color:"cyan",key:"note-edit",onClick:function(){return n(e)},label:"edit"}),r.a.createElement(le,(t={key:"note-sync",color:"green"},Object(re.a)(t,"key","note-save"),Object(re.a)(t,"onClick",(function(){return c(e)})),Object(re.a)(t,"label","save"),t)),r.a.createElement(le,(a={key:"note-sync",color:"red"},Object(re.a)(a,"key","note-delete"),Object(re.a)(a,"onClick",(function(){return o(e)})),Object(re.a)(a,"label","delete"),a))],style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",null,e.name))}}),r.a.createElement("br",null),r.a.createElement(ue,{enterButton:"Add Note",size:"medium",value:d,onChange:function(e){return m(e.target.value)},onSearch:function(e){e&&l(e),m("")}}))},de=function(e){var t=e.refetchList,n=Object(l.c)(),a=Object(l.d)((function(e){return e.notes})),o=Object(l.d)((function(e){return e.repository})),c=Object(l.d)((function(e){return e.auth}));return r.a.createElement(se,{notes:a,editNote:function(e){n(function(e){return{type:"LOAD_NOTE",text:e.text,noteId:e.oid}}(e)),n({type:"HIDE_MODAL"})},deleteNote:function(e){var n=q("DELETE_FILE",o.nameWithOwner.split("/")[0],o.nameWithOwner.split("/")[1],"notes/".concat(e.name,"/index.md")),a={message:"Delete Note(solitude-bot)",sha:e.sha},r={Authorization:"Bearer ".concat(c.token),"Content-Type":"application/json"};fetch(n,{method:"DELETE",body:JSON.stringify(a),headers:r}).then((function(e){return e.text()})).then((function(e){t()})).catch((function(e){return console.log("error",e)}))},saveNote:function(e){var n=q("UPDATE_FILE",o.nameWithOwner.split("/")[0],o.nameWithOwner.split("/")[1],"notes/".concat(e.name,"/index.md")),a={Authorization:"Bearer ".concat(c.token),"Content-Type":"application/json"},r={message:"Update Note ".concat(e.name,". (solitude-bot)"),content:btoa(e.text),sha:e.sha};fetch(n,{method:"PUT",body:JSON.stringify(r),headers:a}).then((function(e){return e.text()})).then((function(e){t()})).catch((function(e){return console.log("error",e)}))},createNote:function(e){var n=q("CREATE_FILE",o.nameWithOwner.split("/")[0],o.nameWithOwner.split("/")[1],"notes/".concat(e,"/index.md")),a={message:"Create Note ".concat(e,".(solitude-bot)"),content:btoa("# "+e)},r={Authorization:"Bearer ".concat(c.token),"Content-Type":"application/json"};fetch(n,{method:"PUT",body:JSON.stringify(a),headers:r}).then((function(e){return e.text()})).then((function(e){t()})).catch((function(e){return console.log("error",e)}))}})};function me(){var e=Object(R.a)(["\n  query LoadNote($owner: String!, $name: String!, $expression: String!) {\n    repository(owner: $owner, name: $name) {\n      id\n      name\n      nameWithOwner\n      notes: object(expression: $expression) {\n        ... on Tree {\n          entries {\n            name\n            oid\n            object {\n              ... on Tree {\n                entries {\n                  name\n                  oid\n                  object {\n                    id\n                    ... on Blob {\n                      text\n                    }\n                  }\n                }\n              }\n              commitUrl\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return me=function(){return e},e}var he=Object(M.b)(me()),fe=function(e){var t=e.updateRepository,n=e.updateNotesList,o=Object(a.useState)(!0),c=Object(i.a)(o,2),u=(c[0],c[1],Object(l.d)((function(e){return e.auth.userName}))),s=Object(l.d)((function(e){return e.notes})),d=(Object(l.c)(),{owner:u,name:"".concat(u,"-solitude-notes"),expression:"master:notes/"}),m=Object(x.b)(he,{variables:d}),h=m.loading,f=m.error,p=m.data,E=m.refetch;return Object(a.useEffect)((function(){var e=function(e){var a=e.repository,r=a.id,o=a.name,c=a.nameWithOwner,i=a.notes,l=[];Object(J.isEmpty)(i)||(l=function(e){var t=[];return e.forEach((function(e){var n=e.object.entries.find((function(e){return"index.md"===e.name}));t=[].concat(Object(F.a)(t),[{name:e.name,oid:e.oid,text:n.object.text,sha:n.oid}])})),t}(i.entries)),n(l),t({id:r,name:o,nameWithOwner:c,loading:h})},a=function(e){t({loading:h}),console.log(e)};(e||a)&&(!e||h||f?a&&!h&&f&&a(f):p.repository.notes.entries.length!==s.length?e(p):console.log("Lists are not updated."))}),[h,p,f]),r.a.createElement("div",null,h?r.a.createElement("span",null,"Loading..."):r.a.createElement(r.a.Fragment,null,p?r.a.createElement("div",null,r.a.createElement("h3",null,p.repository.nameWithOwner),r.a.createElement(de,{refetchList:E})):r.a.createElement("p",null,"No solitude managed repository exists!")))};function pe(){var e=Object(R.a)(["\n  mutation CreateSolitudeNotesRepository(\n    $repoName: String!\n    $templateRepositoryId: String!\n    $ownerId: String!\n  ) {\n    cloneTemplateRepository(\n      input: {\n        name: $repoName\n        repositoryId: $templateRepositoryId\n        ownerId: $ownerId\n        visibility: PRIVATE\n      }\n    ) {\n      repository {\n        name\n      }\n    }\n  }\n"]);return pe=function(){return e},e}var Ee=Object(M.b)(pe()),be=function(e){var t,n,o,c=e.auth,l=e.updateRepository,u=Object(x.a)(Ee),s=Object(i.a)(u,2),d=s[0],m=s[1].data,h=(t=B.TEMPLATE_REPOSITORY_ID,n=c.id,o=c.userName,{repoName:"".concat(o,"-solitude-notes"),templateRepositoryId:t,ownerId:n});return Object(a.useEffect)((function(){m&&m.cloneTemplateRepository&&l(m.cloneTemplateRepository.repository)}),[m]),r.a.createElement(ae,{label:"Create",onClick:function(e){d({variables:h})}})},Oe={GIT_MODAL:Object(l.b)((function(e){return{auth:e.auth,repository:e.repository}}),(function(e){return{hideModal:function(){return e({type:"HIDE_MODAL"})},updateRepository:function(t){return e(function(e){return{type:"REGISTER_SOLITUDE_REPO",repo:e}}(t))},updateNotesList:function(t){return e(function(e){return{type:"UPDATE_NOTE_LIST",list:e}}(t))}}}))((function(e){var t=e.auth,n=e.isOpen,o=(e.modalProps,e.hideModal),c=e.updateRepository,i=e.updateNotesList,l=e.repository;return Object(a.useEffect)((function(){c({loading:!0})}),[]),r.a.createElement(Z,{isModalOpen:n,modalTitle:"Your notes",modalBody:t.token?r.a.createElement("div",null,r.a.createElement(fe,{updateRepository:c,updateNotesList:i}),!l.loading&&!l.name&&r.a.createElement(be,{auth:t,updateRepository:c})):r.a.createElement(ae,{label:"Connect to GitHub",onClick:function(e){return function(e){e.preventDefault();var t,n=(t=B.GITHUB_APP_CLIENT_ID,"https://github.com/login/oauth/authorize?client_id=".concat(t,"&scope=repo"));window.location.href=n}(e)}}),onModalClose:o})}))},ge=Object(l.b)((function(e){return{modal:e.modal}}))((function(e){var t=e.modal;if(console.log(t.modalType),!t.modalType)return null;var n=Oe[t.modalType];return r.a.createElement(n,t)})),ve=n(25),ye=function(e){return new M.a({uri:"https://api.github.com/graphql",request:function(t){t.setContext({headers:{authorization:e?"Bearer ".concat(e):""}})}})};n(582),n(583),n(584),n(585);var Te=Object(l.b)(null,(function(e){return{onTokenChange:function(t){return e(function(e){return{type:"UPDATE_TOKEN",token:e}}(t))}}}))((function(e){var t=e.onTokenChange,n=(e.authToken,Object(a.useState)("")),o=Object(i.a)(n,2),c=o[0],l=o[1];Object(a.useEffect)((function(){var e=window.location.href.match(/\?code=(.*)/)&&window.location.href.match(/\?code=(.*)/)[1];e&&fetch("https://solitudenote-gitkeeper.glitch.me/authenticate/".concat(e)).then((function(e){return e.json()})).then((function(e){var n=e.error,a=e.access_token;if(n)throw Error(n);l(a),t(a)})).catch((function(e){console.log(e)}))}),[]);var u=ye(c);return r.a.createElement("div",null,r.a.createElement(ve.a,{client:u},r.a.createElement(f,null),r.a.createElement(ee,null),r.a.createElement(A,null),r.a.createElement(ge,null)))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var we=n(67),je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_EDITOR_STATE":return t.editorState||e;default:return e}},ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{size:"50%"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_PANE_SIZE":return Object(ce.a)({},e,{size:t.size});default:return e}},_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{markdownValue:"",noteId:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_MARKDOWN_VALUE":return Object(ce.a)({},e,{markdownValue:t.text});case"LOAD_NOTE":return Object(ce.a)({},e,{noteId:t.noteId,markdownValue:t.text});default:return e}},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{token:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_TOKEN":return Object(ce.a)({},e,{token:t.token});case"UPDATE_GIT_USER":return Object(ce.a)({},e,{userName:t.login,id:t.id});default:return e}},Ce={},Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_MODAL":return Object(ce.a)({},e,{isOpen:!0,modalType:t.modalType,modalProps:t.modalProps});case"HIDE_MODAL":return Object(ce.a)({},Ce,{isOpen:!1});default:return e}},Ie={loading:!0},De=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REGISTER_SOLITUDE_REPO":case"UPDATE_SOLITUDE_REPO":return Object(ce.a)({},e,{},t.repo);default:return e}},Ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_NOTE_LIST":return Object(F.a)(t.list);case"UPDATE_NOTE":return e.map((function(e){return e.oid!==t.oid?e:Object(ce.a)({},e,{text:t.text,isDirty:t.isDirty})}));default:return e}},Pe=Object(we.b)({editorValue:_e,editor:je,splitPane:ke,modal:Ne,auth:Se,repository:De,notes:Ae}),Le=Object(we.c)(Pe,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());c.a.render(r.a.createElement(l.a,{store:Le},r.a.createElement(Te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},69:function(e){e.exports=JSON.parse('{"GITHUB_APP_CLIENT_ID":"b4b9cca2169de74f183e","GITHUB_APP_REDIRECT_URI":"http://localhost:3000/","TEMPLATE_REPOSITORY_ID":"MDEwOlJlcG9zaXRvcnkyMzc2ODIwOTE="}')}},[[211,1,2]]]);
//# sourceMappingURL=main.4582d3f3.chunk.js.map